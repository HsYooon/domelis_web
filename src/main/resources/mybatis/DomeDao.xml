<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.domelist.dome.repository.DomeDao">
    <select id="domeNewPrdList" resultType="DomeDto" parameterType="int">
        <![CDATA[
        with v1 as (
            SELECT *
            FROM t_domelist
            WHERE info = '11'
            order by rand() desc
        ) select *
          from v1 limit #{start} , #{end}
        ]]>
    </select>

    <select id="domeBestPrdList" resultType="DomeDto" parameterType="int">
        <![CDATA[
        with v1 as (
            SELECT *
            FROM t_domelist
            WHERE info = '12'
            order by rand() desc
        ) select *
        from v1 limit #{start} , #{end}
        ]]>
    </select>

    <select id="bestProductList" resultType="DomeDto" parameterType="int">
        <![CDATA[
        SELECT id
             ,name
             ,img
             ,url
             ,title
             ,category
        from t_domelist
        where info = '12'
        order by rand() desc, id desc
        limit #{cnt}
        ]]>
    </select>
    <select id="todayProductList" resultType="DomeDto" parameterType="int">
        <![CDATA[
        SELECT id
             ,name
             ,img
             ,url
             ,title
             ,category
        from t_domelist
        where info = '11'
        order by rand() desc, id desc
        limit #{cnt}
        ]]>
    </select>
    <select id="siteInfoList" resultType = "SiteInfoDto" parameterType="string">
    select id
           , name
           , url
           , info
           , img
           , category
    from t_siteinfo
    <if test="cd != null and cd != 'all'">
    where category = #{cd}
    </if>
    </select>

    <select id="categoryNm" resultType="string" parameterType="string">
        select name
        from t_category_cd
        where cd = #{cd}
    </select>
    <select id="prdMainNewList" resultType="DomeDto">
        SELECT id
             ,name
             ,img
             ,url
             ,title
             ,category
        from t_domelist
        where info = '11'
        order by rand() desc, id desc
        limit 12
    </select>

    <select id="prdMainBestList" resultType="DomeDto">
        SELECT id
             ,name
             ,img
             ,url
             ,title
             ,category
        from t_domelist
        where info = '12'
        order by rand() desc, id desc
            limit 12
    </select>

    <select id="marketPostList" resultType="MarketPostDto">
        select id, title from t_post
    </select>

    <select id="marketPost" resultType="MarketPostDto" parameterType="int">
        select title, writer, article, DATE_FORMAT(reg_dttm, '%Y-%m-%d')
        from t_post
        where id = #{id}
    </select>

    <select id="domesticList" resultType = "DeliveryDto" parameterType="int">
    SELECT id, name, img, url, description
    from t_delivery
    where category = '10' order by id
    <if test='cnt!=0'>
        LIMIT #{cnt}
    </if>
    </select>

    <select id="abroadList" resultType = "DeliveryDto" parameterType="int">
        SELECT id, name, img, url, description
        from t_delivery
        where category = '11' order by id
        <if test='cnt!=0'>
        LIMIT #{cnt}
        </if>
    </select>

    <select id="searchPrd" resultType="DomeDto" parameterType="string">
        select *
        from t_domelist
        where title like CONCAT('%',#{query},'%')
    </select>
</mapper>